---
title:  多线程相关知识点 
date: 2016-04-23 20:20:43
updated: 2016-04-23 21:19:21
categories: Java多线程
tags: [多线程]
copyright: true
mathjax: true
---
### 引入线程技术背景
1. 一个应用程序中同时存在多个任务，其中部分活动会随时间的推移而阻塞，而另外一部分则不会。例如：一个文字处理软件，前台部分需要从终端设备获得输入或者将处理完的部分输出，而后台线程则可以实现对文字的处理。故对于CPU密集型进程，该用多线程其性能不一定能得到很大提高，但对于IO密集型进程，其性能可得到很大提高。
2. <font color=#FF4500> 线程比进程更轻量级，创建和撤销的代价小，在许多系统中国呢，创建一个线程比一个进程要快10～100倍不等</font>。
3. 在多核CPU中，真正的并行有了可能。即在多线程设计中一部分可用来处理前台任务，一部分可用来处理后台任务，实现真正意义上的并行。
4. 线程间的切换代价要比进程切换的代价小。

<!--more-->

-------

### 引入线程技术背景
1. 某个操作可能会陷入长时间等待，等待的线程会进入睡眠状态，无法继续进行。多线程执行可以有效利用等待时间。如等待网络响应可能需要几秒时间。
2. 某个操作(常常是计算)会消耗大量的时间，如果只有一个线程，程序和用户之间交互会中断。多线程可以让一个线程负责交付，另一个线程负责计算。
3. 多CPU或者多核计算机，本身具备同时执行多个线程的能力，故单线程无法完全发挥计算机的计算能力。
4. 相对于多进程应用，多线层在数据共享方面效率要高得多。
5. 程序逻辑本身就要求并发操作。

-------

### 进程和线程
&emsp;&emsp;进程是操作系统的管理单位，线程则是进程的管理单位。一个线程至少包含一个执行线程。不管是在多线程还是单线程，每个线程都一个程序计数器（记录要执行的下一条指令），一组寄存器（保存当前线程的工作变量），堆栈（记录执行理事，其中每一帧保存了一个已经调用但为返回的过程）。虽然线程***寄生 ***在进程中，但与它的进程是不同的概念，并且可以分别处理：<font color=#FF4500 >进程是系统分配资源的基本单位，线程是调度CPU的基本单位</font>。

| 每个进程中的内容 | 每个线程的内容 |
| --- | --- |
| 地址空间 | 程序计数器 |
| 全局变量 | 寄存器 |
| 打开文件 | 堆栈 |
| 子进程 | 状态 |
| 即将发生的报警 |  |
| 信号与信号处理程序 |  |
| 账户信号 |  |
| 同步、互斥信号量 |  |

-------

### CPU调度
&emsp;&emsp;进程执行由CPU进行周期和I/O等待周期组成。进程在这两个状态之间切换（CPU burst ～ IO burst）
进程执行从CPU区间（CPU burst）开始，在这之后是IO区间（IO burst）。接着另外一个CPU区间，然后是另外一个IO区间，如此进行下去，最后CPU区间通过系统请求中止执行。
经过大量CPU区间长度的测试。发现具有大量短CPU区间和少量长CPU区间。IO约束程序通常具有很多短CPU区间。CPU约束成层序可能有少量的长CPU区间。这种分布有助于选择合适的CPU调度算法。






